* {
  outline-color: gtkalpha(currentColor, 0.07);
  outline-style: solid;
  outline-offset: -2px;
  outline-width: 2px;
  -gtk-outline-radius: 6px;
}

%button_active,
button:active,
button:checked, {
  background: if($variant == 'light', image(darken($bg_color, 7%)), image(darken($bg_color, 14%)));
  box-shadow: inset 0 3px 3px -2px transparentize($shadow_color, 0.03);
}

%slider_active {
  background-image: if($variant == 'light', image(lighten($bg_color, 14%)), image(darken($bg_color, 9%)));
}

/**********
 * Switch *
 **********/
switch {
  $_slider_border_color: darken($alt_borders_color, 3%);

  slider {
      @include button(normal-alt, $edge: $shadow_color);

      border: 1px solid $_slider_border_color;
      border-radius: 50%;
      transition-property: background, border, box-shadow;
  }

  &:hover slider {
    @extend %slider_active;
    border-color: $suggested_bg_color;
  }

  &:checked slider {
    border-color: if($variant=='light', $suggested_border_color, $_slider_border_color);
  }

  &:backdrop {
    slider { border-color: $backdrop_borders_color; }

    &:checked slider {
      border-color: if($variant=='light', $suggested_bg_color, $backdrop_borders_color);
    }
  }
}

/************
 * GtkScale *
 ************/
scale slider:active {
  @extend %slider_active;

  border-color: $suggested_bg_color;
}

/***************
 * Header bars *
 ***************/
.titlebar,
headerbar {
  border-color: $selected_bg_color;

  $_scale_asset: 'assets/kali-headerbar-logo#{$asset_suffix}';
  @include headerbar_fill(darken($bg_color, if($variant == 'light', 2%, 10%)),
                          $ov: -gtk-scaled(url('#{$_scale_asset}.png'), url('#{$_scale_asset}@2.png')));
  background-repeat: no-repeat;
  background-position: left;

  &:backdrop {
    background-image: -gtk-scaled(url('#{$_scale_asset}.png'), url('#{$_scale_asset}@2.png'));
    background-repeat: no-repeat;
    background-position: left;
  }

  stackswitcher button:checked,
  button.toggle {
    &:active, &:checked { @extend %button_active; }
  }
}

/**************
 * GtkInfoBar *
 **************/
infobar {
  @mixin _infobar_button($bg) {
    button {
      // FIXME: extend selection mode buttons
      @include button(normal, $bg, $selected_fg_color, none);

      &:hover { @include button(hover, $bg, $selected_fg_color, none); }

      &:active,
      &:checked { @include button(active, $bg, $selected_fg_color, none); }

      &:disabled { @include button(insensitive,$bg,$selected_fg_color,none); }

      &:backdrop {
        @include button(backdrop, $bg, $selected_fg_color, none);
        border-color: _border_color($bg);

        &:disabled {
          @include button(backdrop-insensitive, $bg,
                          $selected_fg_color, none);
          border-color: _border_color($bg);
        }
      }
      &:backdrop, & {
        label, & { color: $selected_fg_color; }
      }
    }
  }

  &,
  &.info,
  &.question,
  &.warning,
  &.error {

  border-style: none;
  text-shadow: none;

    &:backdrop > revealer > box, & > revealer > box {
      label, & { color: $selected_fg_color; }
    }

    &:backdrop { text-shadow: none; }

    selection { background-color: darken($bg_color, 10%); }

    *:link { color: $link_color; }
  }

  &.info {
    &:backdrop > revealer > box, & > revealer > box {
      background-color: $selected_bg_color;
    }

    @include _infobar_button($selected_bg_color);
  }

  &.question, &.warning {
    &:backdrop > revealer > box, & > revealer > box {
      background-color: $warning_color;
    }

    @include _infobar_button($warning_color);
  }

  &.error {
    &:backdrop > revealer > box, & > revealer > box {
      background-color: $error_color;

      @include _infobar_button($error_color);
    }
  }
}

/*********************
 * App Notifications *
 *********************/
.app-notification,
.app-notification.frame {
  padding: 5px;
  margin: 20px;
  border-radius: 5px;
  box-shadow: 0 2px 8px 0 transparentize(black, .6);
  background-image: none;

  &:backdrop { box-shadow: none; }
}

/***********
 * Dialogs *
 ***********/
messagedialog .titlebar:backdrop { background-image: none; }

/**********************
 * Window Decorations *
 *********************/
decoration {
  box-shadow: 0 2px 8px 0 transparentize(black, 0.6);

  &:backdrop {
    box-shadow: 0 2px 8px 0 transparent,
                0 0 0 3px if($variant == 'light', transparentize(black, .85), transparentize(black, .75));
  }

  .ssd & { box-shadow: none; }

  .csd.popup & { box-shadow: 0 1px 4px transparentize(black, 0.8); }

  messagedialog.csd & { box-shadow: 0 1px 4px transparentize(black, 0.8); }
}
